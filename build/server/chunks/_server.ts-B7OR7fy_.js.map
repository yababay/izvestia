{"version":3,"file":"_server.ts-B7OR7fy_.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/publish/_webhook_/_server.ts.js"],"sourcesContent":["import { g as getConnection } from \"../../../../chunks/connection.js\";\nconst GET = async () => {\n  const client = await getConnection();\n  const today = (/* @__PURE__ */ new Date()).toISOString().substring(5, 10);\n  let key = `approved:${today}`;\n  console.log(key);\n  if (!await client.exists(key)) return new Response(\"not found\", { status: 404 });\n  const members = await client.sMembers(key);\n  key = `publish:${today}`;\n  if (!await client.exists(key)) {\n    await client.lPush(key, ...members);\n    await client.expire(key, 3600 * 24);\n  }\n  await client.rPopLPush(key);\n  return new Response(\"ok\");\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;;;;;AACK,MAAC,GAAG,GAAG,YAAY;AACxB,EAAE,MAAM,MAAM,GAAG,MAAM,aAAa,EAAE;AACtC,EAAE,MAAM,KAAK,GAAG,iBAAiB,IAAI,IAAI,EAAE,EAAE,WAAW,EAAE,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;AAC3E,EAAE,IAAI,GAAG,GAAG,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;AAC/B,EAAE,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC;AAClB,EAAE,IAAI,CAAC,MAAM,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,OAAO,IAAI,QAAQ,CAAC,WAAW,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AAClF,EAAE,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC;AAC5C,EAAE,GAAG,GAAG,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;AAC1B,EAAE,IAAI,CAAC,MAAM,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE;AACjC,IAAI,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,OAAO,CAAC;AACvC,IAAI,MAAM,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI,GAAG,EAAE,CAAC;AACvC;AACA,EAAE,MAAM,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC;AAC7B,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC;AAC3B;;;;"}